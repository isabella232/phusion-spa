<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, user-scalable=yes">

    <script src="../../webcomponentsjs/webcomponents-lite.js"></script>
    <script src="../../web-component-tester/browser.js"></script>

    <link rel="import" href="../../polymer/polymer.html">
    <link rel="import" href="../lib/phusion-spa.html">
  </head>
  <body>

    <script>
      MockRouter = function() {
        return {
          routes: [],
          on: function(view, callback) {
            this.routes.push([view, callback]);
          }
        };
      };
    </script>

    <spa-routes router-class="MockRouter">
      <spa-view route="first_route"></spa-view>
      <spa-view route="second_route"></spa-view>
    </spa-routes>

    <script>
      var routes = document.querySelector('spa-routes');
      var view1 = document.querySelector('spa-view');

      describe('<spa-routes>', function() {

        it('has a router', function() {
          assert.isObject(routes.router);
          expect(routes.router).to.respondTo('on');
          expect(routes.router).to.have.property('routes');
        });

        it('registers children with the route property', function() {
          var first_route = routes.router.routes[0];
          expect(first_route).to.exist;
          expect(first_route[0]).to.eq('first_route');
        });

        it('registers two children with the route property', function() {
          var second_route = routes.router.routes[1];
          expect(second_route).to.exist;
          expect(second_route[0]).to.eq('second_route');
        });

      });

      describe('<spa-view>', function() {
        it('has a route property', function() {
          assert.isObject(view1);
          expect(view1).to.have.property('route');
          expect(view1.route).to.eq('first_route');
        });

        it('has a visit function', function() {
          expect(view1).to.respondTo('visit');
        });
      });
    </script>

  </body>
</html>
